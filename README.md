# User Journey Prediction with Markov Chains and Neural Networks

This project combines high-order Markov chain algorithms with neural networks to predict user navigation paths and classify user journeys as 'desired' or 'undesired' flows on a website.

## Project Overview

- **Markov Chain Algorithm**: Predicts the next page a user is likely to visit based on historical traversal data, using first, second, and third-order Markov models.
- **Neural Network Classifier**: Uses the output of the Markov model and labeled data (desired/undesired flows) to train a neural network that predicts the likelihood of a user following a desired path.
- **Visualization**: Generates and saves confusion matrix plots to evaluate model performance.

## Folder Structure

```
user-journey-ml/
├── api/                # (Reserved for API code)
├── data/               # Contains CSV files with user traversal and probability data
│   ├── probability-data.csv
│   └── user-traversals.csv
├── helpers/            # Helper modules (e.g., destination page definitions)
│   └── destination_pages.py
├── src/
│   ├── scripts/
│   │   ├── Markov-Chain.py        # Markov chain computation and probability export
│   │   ├── Neural_Network.py      # Neural network training and evaluation
│   │   └── Visualization.py       # Visualization utilities (e.g., confusion matrix)
│   └── visualization/             # Output folder for generated plots
├── tests/              # (Reserved for test scripts)
├── requirements.txt    # Python dependencies
├── README.md           # Project overview and instructions
├── .gitignore
└── secrets.md          # Project description and notes
```

## Data Files

- `data/user-traversals.csv`: Raw user navigation paths.
- `data/probability-data.csv`: Markov chain transition probabilities (generated by Markov-Chain.py).

## Main Scripts

- `src/scripts/Markov-Chain.py`: Computes Markov chain transition probabilities from user data.
- `src/scripts/Neural_Network.py`: Trains a neural network to classify user journeys using Markov features and desired/undesired labels.
- `src/scripts/Visualization.py`: Plots and saves confusion matrices for model evaluation.

## Helper Modules

- `helpers/destination_pages.py`: Defines which pages are considered 'desired' or 'undesired' destinations for labeling.

## Visualization Output

- Plots (e.g., confusion matrices) are saved to `src/visualization/`.

## Requirements

Install dependencies with:

```
pip install -r requirements.txt
```

## Usage

1. Run the Markov chain script to generate transition probabilities:
   ```
   python src/scripts/Markov-Chain.py
   ```
2. Train and evaluate the neural network:
   ```
   python src/scripts/Neural_Network.py
   ```
3. Generate and save the confusion matrix plot:
   ```
   python src/scripts/Visualization.py
   ```

---

For more details, see `secrets.md`.
